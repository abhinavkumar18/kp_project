select 
case_followup_id, ac.case_id, acm.cmb_dtl_id followup_status_code,
acm.cmb_dtl_name followup_status_name, f.crt_dt,  ap.patient_id, ap.ration_card_no, 
ap.resident_id, ap.first_name patient_name, -- ap.aadhar_no, 
(select distinct UID_NO from(
        SELECT  UID_NO FROM ASRIT_JANMABHOOMI_FAMILY  WHERE RESIDENT_ID = AP.RESIDENT_ID  and active_yn = 'Y'
        UNION ALL
        SELECT  UID_NO FROM ASRIT_TAP_FAMILY_AP WHERE RESIDENT_ID = AP.RESIDENT_ID   and active_yn = 'Y'
        UNION ALL 
        SELECT  UID_NO FROM ASRIT_FAMILY_CS_AP WHERE RESIDENT_ID = AP.RESIDENT_ID  and active_yn = 'Y'

    ) WHERE ROWNUM = 1
    ) AADHAR_NO

from asrit_case_followup_claim f
left join asrit_case ac on ac.case_id = f.case_id
left join asrit_patient ap on ap.patient_id = ac.case_patient_no
left join asrim_combo acm on acm.cmb_dtl_id = f.payment_status
where f.payment_status = 'CD412'
and to_date(f.crt_dt) = to_date(sysdate) - 1
order by f.crt_dt desc

spring.mail.host=10.10.223.151
spring.mail.port=25
spring.mail.username=biometricissues@ysraarogyasri.ap.gov.in
spring.mail.password=Password@123
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

Password@1123

SELECT dcf.merged_request_number,dcf.admin_sanction_number,
SUM(dcp.amount) AS total_sanctioned_amount,dcf.remarks AS overall_remarks,
STRING_AGG('(' || COALESCE(dcpm.particular_description, dcp.particular_name) || ' : ' || dcp.amount || ')', ', ') AS particular_wise_amount,
stm.case_status_name AS case_StatusName,
dm.district_name AS district_Name,dcf.year_raised_for AS raised_Year,gtm.type_name AS raised_Month,dcf.crt_on AS raised_On
FROM ysr.ysr_dc_forms dcf
LEFT JOIN ysr.ysr_dc_forms_pariculars_list dcp ON dcp.form_id = dcf.form_id
LEFT JOIN ysr.ysr_dc_forms_particulars_mst dcpm ON dcpm.particular_id = dcp.particular_id
LEFT JOIN ysr.ysr_step_role_mapping stm ON stm.step_role_id = dcf.status
LEFT JOIN ysr.ysr_user_district_mapping udm ON udm.user_id = dcf.crt_by
LEFT JOIN ysr.ysr_district_mst dm ON dm.dist_id = udm.district_id
LEFT JOIN ysr.ysr_general_type_mst gtm ON gtm.type_id = dcf.month_raised_for
WHERE dcf.status = 274 and dcf.merged_request_number = 'DC_MER/2024/0000026'
GROUP BY dcf.merged_request_number,dcf.admin_sanction_number, dcf.remarks,stm.case_status_name, dm.district_name, dcf.year_raised_for,gtm.type_name, dcf.crt_on
ORDER BY dcf.admin_sanction_number;


SELECT 
    dm.district_name AS District,
    SUM(dcp.amount) AS total_amount_raised,
    COUNT(CASE WHEN dcf.form_type= '1' THEN 1 END) AS no_of_office_expense_form_submitted,
    COUNT(CASE WHEN dcf.form_type= '2' THEN 1 END) AS no_of_hired_travel_expense_form_submitted
FROM ysr.ysr_dc_forms dcf
LEFT JOIN ysr.ysr_dc_forms_pariculars_list dcp ON dcp.form_id = dcf.form_id
LEFT JOIN ysr.ysr_dc_forms_particulars_mst dcpm ON dcpm.particular_id = dcp.particular_id
LEFT JOIN ysr.ysr_user_district_mapping udm ON udm.user_id = dcf.crt_by
LEFT JOIN ysr.ysr_district_mst dm ON dm.dist_id = udm.district_id
WHERE dcf.status = 274
GROUP BY dm.district_name
ORDER BY dm.district_name;
